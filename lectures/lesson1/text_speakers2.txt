Отчет подготовлен mymeet.ai
cv-0809-P2
Дата: 08.09.2025 16:47:04
Ключевые слова: Контраст изображения, Матрица хоралика, Шум и фильтрация, Оценка качества изображения, Гистограмма
Участники: Speaker A, Speaker B, Speaker C, Speaker D
Супер краткое содержание
•	Представлены методы оценки контраста изображений: гистограммы, контраст Михельсона, глобальный и среднеквадратичный контраст, контраст Хоралика.
•	Матрица Хоралика (256x256) используется для анализа соседств пикселей по яркости с учётом 4- и 8-соседств.
•	Симметричность матрицы позволяет оптимизировать вычисления, учитывая взаимное соседство яркостей.
•	Различные виды шумов (равномерный, нормальный) применяются для визуализации и анализа поведения матриц Хоралика.
•	Метрики качества изображений делятся на с эталонным изображением (Full Reference) и без него.
•	Среднеквадратичная ошибка и Signal Noise Ratio используются для количественной оценки ухудшения качества.
•	Structural Similarity Index (SSIM) представляет более сложный метод оценки качества с референсом.
•	Обсуждены практические примеры и инструменты (Scikit-Learn) для построения и анализа матриц Хоралика.
•	Планируется дальнейшее изучение более сложных методов оценки качества изображений на последующих лекциях.
Саммари по темам
Оценка контраста изображений с использованием различных методов и метрик.
•	Использование гистограмм для анализа контраста в изображениях с узким диапазоном значений (16 значений).
•	Контраст Михельсона: вычисляется как (максимальное значение - минимальное) / максимальное значение, изменяется от 0 до 1, где 0 — плохо, 1 — отлично.
•	Глобальный контраст: разница между максимальной (255) и минимальной яркостью пикселя, в 8-битных изображениях максимум 255.
•	Среднеквадратичный контраст: основан на дисперсии яркости пикселей, даёт численную оценку контраста.
•	Контраст Хоралика: вычисляется на основе матрицы Хоралика (256x256), которая отражает соседства пикселей по яркости и их распределение в изображении.
Матрица Хоралика и её применение для анализа соседств пикселей в изображениях.
•	Матрица Хоралика размером 256x256 отражает количество соседств пикселей с определёнными яркостями (0-255).
•	Используются 4-соседства (вверх, вниз, влево, вправо) и 8-соседства (включая диагонали) для анализа соседств.
•	Симметричность матрицы позволяет экономить ресурсы, учитывая, что соседства пикселей с яркостями A и B равнозначны соседствам с яркостями B и A.
•	Матрица помогает выявлять особенности изображений, например, наличие шума и распределение яркостей.
•	Применение библиотеки Scikit-Learn для автоматизации построения и анализа матриц Хоралика.
Использование шумов для анализа и визуализации матриц Хоралика.
•	Применение различных видов шумов (равномерный, нормальный) для изучения поведения матриц Хоралика.
•	Равномерный шум приводит к равномерному распределению соседств пикселей, матрица выглядит заполненной.
•	Нормальный шум с центром около 127,5 проявляется в характерном 'пухании' матрицы в центре.
•	Шумы помогают выявить особенности и качество изображений, например, недостаточный контраст или наличие артефактов.
Метрики качества изображений с и без эталонного (референсного) изображения.
•	Full Reference Quality Metrics используются при наличии эталонного изображения для сравнения и оценки качества.
•	Среднеквадратичная ошибка (MSE) измеряет разницу между эталонным и зашумлённым изображением, идеальное значение — 0.
•	Signal Noise Ratio (SNR) и его логарифмическая версия применяются для оценки соотношения сигнала и шума.
•	Structural Similarity Index (SSIM) — более продвинутый метод оценки качества с референсом, основанный на структурном сходстве изображений.
•	Отсутствие референсного изображения — более частая ситуация, требующая других подходов к оценке качества.
Задачи
•	Разобраться с проблемой до следующего занятия (Ответственный: Speaker A, Срок: Следующее занятие)
•	Вставить формулу контраста хоралика в материалы лекции (Ответственный: Speaker B)
•	Написать скрипт для ручного подсчёта матрицы хоралика и проверки контраста (Ответственный: Speaker A)
•	Поэкспериментировать с параметрами матрицы хоралика (дистанция, углы, симметричность) и проанализировать результаты (Ответственный: Speaker A)
•	Подготовить и разослать лекцию по метрикам качества изображений с примерами и формулами (Ответственный: Speaker A)
•	Скопировать и оформить материал по structural similarity index для дальнейшего использования в лекциях (Ответственный: Speaker B)
1. Введение в контраст и гистограммы изображений
0:00:03 Speaker A: Вот, все, проблема решена. Ну ладно, я, в общем, разберусь к следующему занятию с этим. Так, окей. Давайте, да, к нашим гистограммам.
0:00:16 Speaker B: Ну сейчас быстренько уже у нас время еще как раз 40 минут, я думаю, мы закончим.
0:00:29 Speaker A: Ну, как видите, здесь уже вообще все в максимально узком диапазоне стало. От 100 до... На 16 мы поделили. Это что-то вот какие-то там 32 значения. Или сколько? 16 даже значений. Да, 16 значений. Совсем малоинформативно стало. Ну, давайте это я закаменчу. В общем, гистограмма позволяет нам увидеть вообще, что с изображением в плане контраста. Без каких-то даже пока интегральных оценок. Ну, теперь, собственно, к оценкам, которые могут быть представлены единым числом. Есть контраст Михельсона. Он как раз-таки не очень нам скажет о динамическом диапазоне, но он нам общую картину какую-то опишет. То есть мы берем просто тупо... максимальное наше значение, вычитаем минимальное, то есть диапазон, на котором все это задействовано, и делим, по сути, в нашем случае на просто максимальное значение, потому что минимальное у нас равно 0. Понятно, что там какие-то другие ситуации немножко по-другому получатся, но вот, в общем, такой способ оценки. Это просто какое-то число, Понятно, оно само по себе не сильно информативно, но в сравнении с чем-то можно посмотреть. Оно меняется от 0 до 1. 0 вообще плохо, 1 все прекрасно. Ну, тут, думаю, понятно. Такой простой подход. Другой вариант.
2. Методы оценки контраста: Михельсон, глобальный и среднеквадратичный контраст
0:02:01 Speaker A: Контраст глобальный. Он еще более очевидный. То есть у нас есть максимальная яркость пикселя в нашем изображении, минимальная яркость пикселя. Это как раз-таки вот этот диапазон между ними мы измеряем. То есть самый яркий был 255, самый темный 0. Получится 255. В случае, если мы там не весь контраст использовали, максимальные арки 170, минимальные арки 50. Вот и получили там 120. Ну и, собственно, буква P. Опять же, эти формулы это уже напрямую из лекции. То есть это такое в нашем случае забегание вперед. Ну, там вы это все тоже еще подробнее посмотрите. Какие-то я сейчас буду так, немножко голопом по Европам, но на лекциях вы как раз поллекции будете рассматривать все их. Поэтому тут избыточно будет. Контраст глобальный. Яркость максимальная, минус яркость минимальная. P это у нас значение, которое описывает сколько ступеней яркости пикселя у нас в нашем распоряжении. То есть в случае с 8 битами это 256 значений, если там больше бит, то, соответственно, больше значений. Но, как правило, большинство изображений, которые мы встречаем в обработке, это вот... Uint 8-битный. Вот. Работаем с тем, что есть. Ну вот в нашем случае с нашей картинкой это 256 минус 1, то есть 255.
0:03:31 Speaker A: Это максимальное значение возможно. Окей. Тоже какое число получили? Ну на самом деле они тут с Михельсоном немножко совпадают. Ну здесь... А, ну это для второго изображения. Окей, для второго они совпадают. Как раз таки потому, что там уже появляется... Появляется уже какое-то зажатие по использованию всего диапазона Еще один способ это среднеквадратичный контраст Ну тут тоже, мы просто есть среднее значение, есть значение пикселей В общем мы считаем, как обычно мы считаем дисперсию вот в какой-то выборке данных Такой же, такой же подход Получаем дисперсию, берем среднеквадратичное. Ну, в общем-то, само его название за себя и говорит. Тоже все это достаточно просто считается, получается. Тоже какую-то оценку нам дает. Окей. Такой тоже способ. Следующий более, более в какой-то степени наглядный, в какой-то степени, наверное, не очень. Ну, в общем, он... позволяет посмотреть тоже это под другим немножечко углом окей это контраст хоралика или матрица хоралика в общем оно там все это немножечко тема шире ну мы сейчас посмотрим да собственно что она из себя представляет как ее сформировать как оттуда контраст получить так сейчас секунду
3. Матрица Хоралика: теория, построение и интерпретация
0:05:14 Speaker B: Создавать я может даже пробую расширить кусочек из лекции спорт картинки есть еще поудобнее Ну ладно, я думаю, сейчас мы пока так. Потом, если что, формулку вставлю сюда.
0:05:55 Speaker A: Окей, берем... Сейчас здесь пока просто для эксперимента берем там некоторые виды шумов стандартные, просто посмотреть на них. Сейчас я их пока загружаю, пока не обращайте внимания.
0:06:07 Speaker B: Так, что-то где-то я его не гружу. Его, может, нету, что ли?
0:06:19 Speaker A: А, все, понял. Походу я поломал здесь изображение, возможно. Хотя нет вроде. Ага. Ну ладно, странно, я не пойму, что он глючит. Ну окей, обойдемся без него, он нам не так, что прям нужен. Нам главное тут какой-нибудь нормальный шум посмотреть, равномерно распределенный. Есть у нас разные виды шумов, они нам просто сейчас помогут увидеть там, как работают вот эти матрицы Хоралека. Ну и как обычно, возьмем наше изображение. Здесь уже какое-то другое у нас подгрузилось. Ну давайте для разнообразия другого кота посмотрим. Можно их, в общем-то, и ручками собрать, они не сильно сложные, но можем их, в общем-то, использовать из библиотеки Second Image. Gray Co-Matrix они здесь называются. Ну, это вот, в общем-то, матрицы хоралика или там серые ко-матрицы, может, вот что-то такое. Здесь просто немножко автоматизировано, сразу позволяет их там несколько штук сделать, там отнормализовать и так далее, симметричные, несимметричные. В общем, задумка какая? Давайте она сейчас где-то есть. Ладно, пока туда не полезем.
0:07:52 Speaker B: Сейчас ставлю картиночку. Вот.
0:08:19 Speaker A: Так грузилась но тут собственно здесь вот называется по альтернативному ее названию то есть есть у нас по некая матрица, у которой ширина-высота это p, то есть число яркостей в нашем случае это 0, 1, 2, 3 до 255, 256 штук. В нашем случае она будет размером 256 на 256. Если мы работаем с нашим изображением, пусть там черно-белым одноканальным пока, И у нас описана яркость вот этим Uint 8. То есть минимальное значение 0, максимальное 255. Всего 256 штук. Окей. И у нас вот по горизонтали, по вертикали. Давайте я вот забегу вперед. Есть у нас пиксель, у которого яркость 0, и пиксель, у которого яркость 0. И сколько вот между ними... Опять же, по заданной нами траектории в каком-то ближайшем окружении есть с такой же яркостью пиксель. Даже не с такой же, а с какой-то там. Например, мы можем посчитать, есть с яркостью 100, есть с яркостью 50. Сколько таких соседствующих пикселей. То есть это просто такой способ оценить, какие соседства у нас встречаются. Давайте на примере метода из Scikit-Learn посмотрим, как это можно сделать. Обычно по классике это 4 соседства. Конечно, это все-таки, знаете, околоевристические методы, но, в общем-то, они вполне себе объективную какую-то оценку дают.
0:10:38 Speaker A: То есть матрица описывает какое-то некое соседство между пикселями, точнее, яркости, сколько пикселей с соответствующими яркостями соседствуют. Вот так попробую скажу. Давайте тоже введем понятие 4 соседства, 8 соседства, иногда оно используется. Чего такое 4 соседства? Это, давайте я даже немножко подчеркну.
0:11:07 Speaker D: 4 соседства.
0:11:23 Speaker B: Так, сейчас могу ли я напрямую в зуме подчеркать? Ну, по идее, наверное, могу. Так видно, да, у вас полосочки мои? Да, видно. Все отлично. Так, давайте я их подзатру.
0:11:50 Speaker A: То есть, смотрите, у нас изображение представляет собой какую-то решетку пикселей.
0:12:15 Speaker B: Какую-то я тут... Импровизировано набросал. Не так, чтобы сильно в квадраты попал. Ну ладно.
0:12:27 Speaker A: Ну и то есть у нас здесь значение. Здесь какой-то там троечка по яркости. Здесь какая-нибудь пятерка. Здесь единичка. Здесь нолик. Здесь нолик.
0:12:39 Speaker B: Нолик. Единичка. Единичка. Ну и тут пусть тоже тройка.
0:12:49 Speaker A: Ну и когда мы говорим о соседстве, например, 4 соседства имеются в виду, мы берем за анализ какой-нибудь в серединке пиксель, и 4 соседства это вот сверху, справа, снизу, слева. Это обзывает 4 соседства. 8 соседств, соответственно, еще и диагональные элементы какие-то. Вот. Матрица хоралика, вот эта та самая, она, как правило, сравнивает какой-нибудь пиксель и лежащий, например, сверху. Или сам вот, который у нас исходный пиксель. Давайте я его другим цветом зарисую. И то, что лежит там справа от него. Или то, что лежит слева. То есть таких матриц можно настроить там сколько угодно. Можно их настроить много, потом усреднить. Даже так пойти. Ну, самое базовое использование. Давайте вернемся.
0:13:45 Speaker D: Так как-то расчистить тут
0:14:04 Speaker A: Самое базовое использование — это четыре соседства. То есть мы говорим, дистанция в одном пикселе от нас, от исследуемого пикселя, который в серединке, под углом 0 градусов, под углом π на 4, под углом π на 2 и под углом π. Какие-то такие. Что это у нас получается? На расстоянии единичка. и это 180 слева в нуле справа ну и здесь по диагональкам получается попали мы в пиксели nokia с ней не по диагоналям ну короче половинка еще вот четверть один по диагонали один так мы можем еще два вопрос такой получается если получается у нас получается есть только 9 вариантов углов 8 точнее который мы можем задать Ну, да, в базовом сценарии так, но в целом мы можем там подальше смотреть, в трех пикселях, четырех, сколько хотим.
0:15:03 Speaker C: А, получается, чем больше дистанция, тем больше вариантов углов, да?
0:15:08 Speaker A: Ну, по сути, да. Но, как правило, все-таки берутся в четыре соседства. То есть, по классике, в нуле в 90, 180, 270. Ну, по крайней мере, мы сейчас вот... Мы даже здесь используем чуть-чуть по-другому. По идее, надо 3 четвертых пи взять еще. Ой, не 3 четвертых, господи, 2 третьих. 3 вторых. Полтора, короче. Окей. Ну, опять же, там симметрично, несимметрично тоже обычно оно симметрично получается более-менее. Но, опять же, это можно там поправить, неважно. Ну и нормализация — это считать ли нам вот такие отношения между пикселями в абсолютах или посчитать в относительном состоянии, то есть сколько их поделенное на все количество этих вот пикселей.
0:16:05 Speaker C: Вопрос такой еще раз. На что симметричность влияет, как бы, не совсем понятно.
0:16:11 Speaker A: Ну, то есть, смотрите, если у нас какой-то пиксель, например, пиксель с яркостью 0 и пиксель с яркостью какой-нибудь там, не знаю, единичка, то есть от нашего пикселя 0, например, верхний от него пиксель, это единичка. Ну и как бы от пикселя 1 сверху пиксель с яркостью 0, то это вот как бы симметричная ситуация. И чтобы, не знаю, сэкономить ресурс, потому что оно, как правило, плюс-минус так и получается, чтобы нам сэкономить ресурс, мы можем посчитать просто половинку матрицы и отразить ее, сделать симметричной. А, понятно. Ну, можем сделать несимметричную. На самом деле это просто так глазами мы не увидим, потому что тут степеней много. Окей, ладно, давайте тут тоже я вас призываю потом прогнать, посмотреть, поэкспериментировать. Чего у нас получается? Вот мы задали дистанцию 1. На самом деле мы можем сразу тут побольше дистанции задать, если нам интересно. Тогда получим там побольше матриц. Ну окей, пока тоже не будем это экспериментировать. Ближайшие под углами вот следующими.
0:17:39 Speaker A: Про контрасты сейчас мы вернемся Давайте посмотрим, чего это получается То есть получилось вот матрица 256 на 256 Ну здесь это, короче, скажем так, не знаю, как это обозвать Еще одно измерение по расстояниям и измерение по углам То есть мы по четырем углам ее обработали, получили четыре матрицы Давайте в базовом сценарии сделаем по углам Давайте смотреть только наверху, например, да? P на 2 Наверху и справа Ну или просто наверху оставим один, чтобы нам удобнее было с этим работать Получили контраст, сейчас мы к нему вернемся Получили вот эту нашу матричку размером 256 на 256 Опять же, можем транспонировать, чтобы удобнее с ними там дальше работать Удобнее выбирать Но в одномерном на самом деле не так важно
4. Применение матрицы Хоралика для анализа шума и визуализация результатов
0:18:38 Speaker C: Извините, а можете еще раз пояснить, почему 256 на 256 матрица, вот этот размер, откуда он взялся?
0:18:44 Speaker A: Да, это как раз-таки соотношение, короче, это диапазон яркостей, возможный, в принципе, в нашем изображении. То есть у нас int8, яркость пикселя от 0 до 255, это, собственно, 256 возможных вариантов. А так как мы сравниваем всех ближайших соседей от нижнего пикселя к верхнему, то возможны сочетания, когда у нас рядом с нулем стоит 0, рядом с нулем стоит 1, рядом с нулем стоит 255, ну и вот весь этот диапазон и все, что между этим. То есть вот у нас рядом с этим нулем может стоять любая яркость. Давайте я тут сделаю, здесь просто на самом деле на серой, как он пишется, по-моему, грей, да, тут.
0:19:39 Speaker B: Так, ну давайте BV попробуем. Так, кто помнит, как они здесь? Что-то я. Цветовые схемы. Веридис, давайте. А, все, не в этом проблема, пардон. Да, потому что я убрал меньше каналов и немножко поломал все это.
0:20:13 Speaker A: Давайте какой-нибудь возьмем gray. Ну, как видите, вот если мы возьмем там в... менее яркую color схему то и пик увидишь тут чего то есть да у нас от были ситуации где соседствовали пиксель вот где-то вот в районе 180 тут довольно концентрирована остальными поменьше даже не видно поэтому вот цветовая схема поудобнее в этом плане тут было призм Сейчас я просто не помню шумы. Нет, я вот не отрисовал. Давайте еще посмотрим. Просто вот это в обычном изображении, когда оно вот хорошо выглядит, натуральное, то есть это фотография, не шумная, оно обычно вот выглядит какую-то такую прямую линию, красивую, встроенную, все хорошо. Если мы сюда сейчас попробуем, сунем какую-нибудь, не наше изображение исходное, а какой-то из шумов,
0:21:22 Speaker B: Давайте но из вот есть мой с такой есть ю.н.
0:21:32 Speaker A: По моему да но из это шум равномерный то мы увидим давайте мы здесь сейчас работает надеюсь и Ну, то есть вот, мы получим какую-то такую историю. Почему это происходит? Потому что шум, ну, он здесь понятно, он тут вроде какой-то около нормальный, но на самом деле такой еще и смещенный чуть-чуть. Ну, скажем так, это проблема скачанной картинки, которая, если бы сгенерировали, было бы поидеальнее. Что это для нас значит? То есть есть такие пиксели, где сверху от пикселя яркостью 100 стоит пиксель яркостью 200, яркостью 150, 100, их достаточно много. То есть типичная ситуация, когда картинка шумная, вот эта матрица-хоралика начинает пухнуть из серединки. То есть она не диагонально красивая, а начинает происходить такая история. Давайте там попробуем, еще есть шум другой, нормальный шум. Вот. Он еще и цветной там что ли, блин. А вот проще сгенерированный шум. Что-то нули, рандом. Давайте вот посмотрим лучше на этот. Он сгенерирован нами самими, поэтому более будет хорошо себя здесь вести. Ну, как видим, тут тоже, на самом деле, контраст сильно большой. Сейчас мы к нему вернемся. Ну вот, это, короче, нормальный шум, по-моему, даже с единичной дисперсией с центром в серединке.
0:23:20 Speaker A: 127,5, наверное. Или 127. То есть у нас вот много таких сочетаний, где пиксели рядом шумные. То есть прям... Это типично для нормального шума выглядящая матрица Хоралека. Там для равномерного распределенного она вообще становится полностью вся. То есть у нас любой пиксель, пиксель любой яркости может встретиться рядом с пикселем другой яркости. То есть это все размазано так равномерно. Сейчас я эту матрицу даже где-то из лекции, наверное, дерну.
0:23:56 Speaker B: Они единственное тут, ну вот, давайте попробую такую вставить.
0:24:05 Speaker A: То есть вот это, на самом деле, это и матрица Харалика справа, а слева это равномерный шум. То есть она будет выглядеть таким образом. Ну ладно, для нас ценнее в этом всем все-таки показатель, который отсюда получается взять. Давайте вернем здесь наш gray image. Вот это наше окошко. Что хорошо, что отсюда мы можем сразу в лоб увидеть. Единственное, да, там маловато очень ярких пикселей, но это мы с вами в гистограмме видели, что да, у нас не соседствуют пиксели высокой яркости с такими же высокояркими. Тут, конечно, их там есть чуть-чуть, но их сильно меньше, чем там, где-то в других областях. Это нам там недоконтрастность вверху какую-то может подсказать. Но на самом деле вот в таком прям виде это не очень удобно. Для этого нам здесь тоже, опять же, есть coprops, как те co-свойства, метод, предоставляемый нам библиотекой, как он считается. Это и есть вот этот контраст Харалика. То есть мы берем, вычитаем значение элементов, берем по модулю и умножаем на их количество, сколько у нас их стоит в этой матричке. Как их посчитать? Ну вот, собственно, я эту матричку увожу.
0:25:39 Speaker A: То есть у нас соседствующих нулей и нулей две штуки, соседствующих единичек и единичек 14 штук, соседствующих нулей... Ой, сейчас, что это у нас получается? Единичек и нулей две штуки. соответствующих троек по яркости и двоек по яркости 6 штучек и так далее троек 17 это это это все мы уже от визуализировали то есть мы берем у нас чтобы получить этот контраст мы вычитаем яркость но в данном случае там 0 минус 0 по модулю 0 неважно единичка минус 0 по модулю единичка умножаем на 2 и Ну и так далее. То есть идем по всем значениям. Понятно, что диагональ для нас здесь теряет смысл, потому что тут вот этот самый разлет исчезает. Все это суммируем и делим на общее число этих пикселей. Понятно, руками это никто никогда в жизни считать не будет, поэтому все это проще какими-то методами посчитать. И мы тем самым получаем какой-то вот контраст Харалика, так называемый. Можно ради интереса проверить, вручную эту матричку пересчитать. Но это кому захочется. Написать небольшой скриптик. Вот. Сейчас здесь я что его ввожу? Наверное, еще раз просто посмотреть, как он выглядит именно в числах. Ну, мы там можем условно первые 30.
0:27:06 Speaker B: Из первых 30 уголочек какой-то посмотреть. Не, ладно, это я что-то не то делаю. Окей. Так, сейчас, знаете, тут еще какую-то картинку из этих.
0:27:32 Speaker A: Ну, а тут просто тоже более приятно это проиллюстрировано. На самом деле, так, чтобы отрисовать это, еще надо помучиться. Сейчас.
0:27:52 Speaker B: Давайте какой-нибудь...
0:28:03 Speaker A: Ну, то есть тоже здесь еще, кроме того, что там можно посчитать вот этот наш контраст хоралека, можно еще и в целом графически чего-то увидеть. Да, ну тут, скажем так, отсюда видно, здесь единственная матрица это перевернутая, да, по отношению к этой. То есть здесь там вот нули внизу. Но я думаю, тут в голове это перевернуть несложно. То есть много темных мест, у нас вот здесь какие-то концентрации, еще немножечко шумы, да, оно пухнет в стороны. Ну а здесь вообще все потеряно. То есть вот исходя из этой матрицы можно много чего на самом деле уже понять об изображении. Второе же выглядит более, более, ну более там, не знаю, для нас для восприятия поприятнее. Но тут тоже, на самом деле, и шумы повылазили. Ну вот здесь как раз уже достаточно много пикселей, которые рядом, и которые достаточно светлые, много темных. Серединка немножко шумная. Ну, в общем, это, скорее всего, из-за обработки. Потому что вот это вот дело вытягивали, подозреваю. Но контраст повыше, да? То есть получше оценка контраста. Чем выше, тем лучше. Так, давайте тоже еще, еще, еще, еще, еще, еще. Тоже прям так по касательно. Это, конечно, лучше вам уже после лекции рассказать. Чтобы все эти формулы сюда не тащить.
0:29:43 Speaker B: Так, ну у нас осталось уже немного времени.
5. Метрики качества изображения с референсом и без: среднеквадратичная ошибка, SNR и SSIM
0:29:54 Speaker A: Ну да давайте пару слов скажем о том как вообще у нас есть там определенные то есть вот условно контраст изображением от сахара лика они нам чет позволяют какие-то выводы о его качестве сделать для дальнейшей обработки И есть какие-то уже такие более интегральные оценки, которые похитрее. Это не просто там контраст, не просто что-то. Ну, матрица Харалика и контраст Харалика — это уже что-то, конечно, посложнее по продвинутей, но, в общем, наука не стояла, и там попридумывали еще кое-чего всякого. Опять же, здесь чисто я, наверное, покажу, как можно использовать готовые некоторые, потому что здесь мы полезем уже в гауссовое сглаживание и прочее. Это немножко более поздние темы. Потом мы, скорее всего, к этому еще сможем вернуться. Ну, просто так, для обзора. Обзора посмотрим. То есть есть... два типа, мы их пока так делим, два типа метрик качества изображений, то есть насколько изображение качественное. Это метрики, которые основаны на сравнении с истинным изображением, какое-то у нас оно есть, то есть это Full Reference Quality Metrics, собственно.
0:31:22 Speaker A: И есть те ситуации, когда у нас нет референсного изображения, то есть нет изображения, каким оно должно быть, что на самом деле в жизни чаще встречается. Не часто у нас бывает изображение идеальное и шумное, и нам почему-то надо как-то оценить, насколько оно шумное, имея при этом идеальное. Но бывают такие ситуации, поэтому есть два вида категории оценки качества изображения. Ну, скажем так, первое — это используется в каком-то там... Ну, например, мы там снимаем одно и то же все время, и у нас есть прям хорошие значения, собранные в каких-то идеальных условиях, и потом у нас это оборудование начинает портиться или еще что-нибудь, и мы начинаем просто мерить, понимая, насколько стало хуже. То есть такой подход. Окей. Ну, давайте, да, сейчас. Ну, насчет, когда у нас есть референс, когда есть с чем сравнивать, здесь на самом деле все... Все схоже с методами определения контраста, только тут с использованием в качестве базы как раз-таки наше изображение идеальное, бесшумное. Давайте сделаем тоже какой-нибудь примерчик. Сделаем нашумим, возьмем, тут опять кота. Добавим к нему шума, нагенерируем шума. Ну, вот какой-то такой у нас шум получился, такого же размера, как код.
0:33:02 Speaker A: Шум у нас здесь, по-моему, это нормальный шум, нормально распределенный. Хоралики потом, если интересно, можете посмотреть. У нас изображение будет немножечко, вот эта наша маточка хоралика, она будет чуть-чуть пухнуть в серединке. Ну, вот как-то нашумели, чего-то насыпали. У нас есть референс, исходное изображение, которое идеальное есть, вот зашумленное. Ну и как нам оценить, насколько оно испортилось? Так можно проверять, насколько испортилась матрица какого-то прибора, что-нибудь такое. Среднеквадратичная ошибка аналогична. Среднеквадратичному контрасту Только мы здесь за Ну нет, не аналогично Неправильно так говорить, конечно То есть мы попиксельно просто смотрим Насколько они вот отлетели, да? Условно от талонного значения Суммируем квадраты Собственно делим на количество вот этих вот пикселей Просто попиксельно все это сделали Ну, собственно, тоже. Вот какое число есть. В идеале оно должно быть ноль. В худшем случае, ну, вот, собственно, что-то очень большое получится. Сколько там? Максимальный возможный разлет 255, если совсем. Но это, если бы у нас абсолютно белое изображение, и мы получали абсолютно черное, да, тут было бы какое-то самое большое число.
0:34:35 Speaker A: Ну, как правило, оно вот какое-то сильно меньше. Окей, это вот самый простой, просто каким-то абсолютным числом посмотреть среднеквадратичную ошибку, насколько стало хуже. Дальше это Signal Noise Rate. Тоже, опять же, тут в лекциях там немножечко подробнее про все это у вас еще будет. Но пока про то как-то посчитать. То есть у нас есть некоторый сигнал, в роли которого могут разные выступать оценки. И есть, собственно, наша Sigma квадрат оценка интенсивности шума. Ну вот, да, можно либо просто контраст изображения посчитать, да, дисперсию от среднего. Просто среднее взять, взять Pmax и поделить, собственно, на наш Sigma квадрат. Ну, опять же, да, это не прям, что сильно все нам меняет. Еще один аналог сигналной зрейты — это под логарифмом. Просто тоже это немножечко более удобно для восприятия. Именно отображение логарифмическое. Но опять же, тоже это мы можем все сделать, посмотреть, какие-то числа получить. Просто что еще тут про это стоит такое сказать? Ну да, это опять же все у нас методы, которые позволяют нам сравнивать с исходным изображением. Есть еще, да, Structural Similarity Index. Это уже, ну это тоже референсный, он там немножечко хитрее.
0:36:22 Speaker A: Сейчас тоже, наверное, в него не полезем. У нас с вами сколько остается? Сейчас, секунду. А, ну у нас минута. Давайте быстренько. Короче, тут я вам сейчас лекцию скину. Вы можете листануть до туда. Потом вам еще Александр Геннадьевич подробнее тоже раскроет. Это так называемая структурная схожесть. Там такая довольно массивная формула. Под ней там лежит неплохая идея. Либо я сюда скопирую это дело. Тоже тут как бы...
0:37:05 Speaker B: Давайте скопирую, чтобы это так голышом тут не лежало.
0:37:13 Speaker A: Тоже это уже такая более продвинутая, более продвинутый подход к оценке, когда у нас есть референсное значение.
